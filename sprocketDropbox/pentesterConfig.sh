#!/bin/bash
#Create openVPN config for the pentester, run on the pentester machine

if [[ $EUID -ne 0 ]]; then
   echo "This script must be run as root" 1>&2
   exit 1
fi

touch /etc/openvpn/pttunnel-client.conf
echo "client" > /etc/openvpn/pttunnel-client.conf
echo "dev tun" >> /etc/openvpn/pttunnel-client.conf
echo "proto tcp" >> /etc/openvpn/pttunnel-client.conf
echo "remote-cert-tls server" >> /etc/openvpn/pttunnel-client.conf
echo "remote <PUB_IP_OF_OPENVPN_SRV> 1194" >> /etc/openvpn/pttunnel-client.conf
echo "remote <PUB_IP_OF_OPENVPN_SRV> 443" >> /etc/openvpn/pttunnel-client.conf
echo "remote <PUB_IP_OF_OPENVPN_SRV> 80" >> /etc/openvpn/pttunnel-client.conf
echo "remote <PUB_IP_OF_OPENVPN_SRV> 53" >> /etc/openvpn/pttunnel-client.conf
echo "persist-key" >> /etc/openvpn/pttunnel-client.conf
echo "persist-tun" >> /etc/openvpn/pttunnel-client.conf
echo "verb 3" >> /etc/openvpn/pttunnel-client.conf
echo "ca <FULL_PATH_TO_CA.crt>" >> /etc/openvpn/pttunnel-client.conf
echo "cert <FULL_PATH_TO_PENTESTER01.crt>" >> /etc/openvpn/pttunnel-client.conf
echo "key <FULL_PATH_TO_PENTESTER01.key>" >> /etc/openvpn/pttunnel-client.conf
echo "cipher AES-256-CBC" >> /etc/openvpn/pttunnel-client.conf
echo "comp-lzo" >> /etc/openvpn/pttunnel-client.conf
echo "Enter the IP of the remote OpenVPN Server> "
read remoteVpn
sed -i "s/<PUB_IP_OF_OPENVPN_SRV>/$remoteVpn/g" /etc/openvpn/pttunnel-client.conf
echo "You should go into the config and modify were your keys are stored.... just sayin."
echo "After doing so run \"openvpn --config pttunnel-client.conf\""